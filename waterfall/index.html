<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="waterfall">
    <img src="http://via.placeholder.com/100x100" alt="300*100">
    <img src="http://via.placeholder.com/100x70" alt="300*70">
    <img src="http://via.placeholder.com/100x150" alt="300*150">
    <img src="http://via.placeholder.com/100x250" alt="300*250">
    <img src="http://via.placeholder.com/100x80" alt="300*80">
    <img src="http://via.placeholder.com/100x90" alt="300*90">
    <img src="http://via.placeholder.com/100x120" alt="300*120">
    <img src="http://via.placeholder.com/100x210" alt="300*210">
    <img src="http://via.placeholder.com/100x230" alt="300*230">
    <img src="http://via.placeholder.com/100x100" alt="300*100">
    <img src="http://via.placeholder.com/100x70" alt="300*70">
    <img src="http://via.placeholder.com/100x150" alt="300*150">
    <img src="http://via.placeholder.com/100x250" alt="300*250">
    <img src="http://via.placeholder.com/100x80" alt="300*80">
    <img src="http://via.placeholder.com/100x90" alt="300*90">
    <img src="http://via.placeholder.com/100x120" alt="300*120">
    <img src="http://via.placeholder.com/100x210" alt="300*210">
    <img src="http://via.placeholder.com/100x230" alt="300*230">
  </div>
  <script>
    var colCount
    var colHeightArray = []
    var imgWidth = $('.waterfall img').outerHeight(true)
    colCount = Math.floor($('.waterfall').width()/imgWidth)
    for(var i=0; i<colCount;i++){
      colHeightArray[i] = 0
    }
    $('.waterfall img').on('load',function(){
      var minValue = colHeightArray[0]
      var minIndex = 0
      for(var i=0;i<colCount;i++){
        if(colHeightArray[i]< minValue){
          minValue = colHeightArray[i]
          minIndex = i
        }
      }
      $(this).css({
        left: minIndex * imgWidth,
        top:minValue
      })
      colHeightArray[minIndex] += $(this).outerHeight(true)
    })

    $(window).on('resize',function(){
      colHeightArray = []
      colCount = Math.floor($('.waterfall').width()/imgWidth)
      for(var i = 0;i<colCount;i++){
        colHeightArray[i] = 0
      }
      $('.waterfall img').each(function(){
        var minValue = colHeightArray[0]
        var minIndex = 0
        
        for(var i=0;i<colCount;i++){
          if(colHeightArray[i]<minValue){
            minValue = colHeightArray[i]
            minIndex = i
          }
        }
      $(this).css({
        left:minIndex * imgWidth,
        top: minValue
      })

      colHeightArray[minIndex] += $(this).outerHeight(true)
    })
    })
  </script>
</body>
</html>
